{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lukin\\\\OneDrive\\\\INF\\\\Gourmet\\\\src\\\\Elements\\\\MainSection\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { MainContainer, InputBar, InputWrapper, Button, MainButtonWrapper, ImagePreview, MainContent, FooterWrapper, ImageUploadContent, ImageButtonWrapper } from './MainSectionDecorations';\nimport '../Styles/suggestions.css';\nimport { sendToServer, convertToDataURLviaCanvas, imgToBase64, getBase64FromUrl } from '../../Functions/upload';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst MainSection = () => {\n  _s();\n\n  const inputBarRef = useRef();\n  const foodNames = [\"kotlet\", \"buraczki\", \"mizeria\", \"arbuz\", \"mleko\", \"melon\", \"maliny\", \"maczek\", \"marucha\", \"marchew\", \"mango\", \"mus owocowy\", \"marmolada\", \"margaryna\", \"marcepan\"];\n  const [hover, setHover] = useState(false);\n  const [previewUrl, setPreviewUrl] = useState(null);\n  const filePickerRef = useRef();\n  const [foodname, setFoodName] = useState(\"\");\n  const [foodimage, setFoodImage] = useState(\"\");\n\n  const onHover = () => {\n    setHover(!hover);\n  };\n\n  useEffect(() => {\n    window.addEventListener('click', event => {\n      var container = document.getElementById('suggestionbox');\n      var tmp = document.getElementsByClassName('suggestion-item');\n\n      if (container !== null) {\n        if (!container.contains(event.target) && tmp.length !== 0) {\n          clearSuggestions();\n        }\n      }\n    });\n  }, []);\n\n  function ImageHandler(event) {\n    if (event.target.files && event.target.files.length === 1) {\n      var dupa = '';\n      var file = event.target.files[0];\n      const reader = new FileReader();\n\n      reader.onloadend = () => {\n        // use a regex to remove data url part\n        const base64String = reader.result.replace(\"data:\", \"\").replace(/^.+,/, \"\"); // log to console\n        // logs wL2dvYWwgbW9yZ...\n        //console.log(base64String);\n\n        var dupa = base64String;\n        setFoodImage(base64String);\n      };\n\n      reader.readAsDataURL(file);\n      setPreviewUrl(URL.createObjectURL(event.target.files[0]));\n      document.getElementById(\"imgbtn\").innerText = \"Edytuj zdjęcie\";\n    }\n  }\n\n  function pickedImageHandler() {\n    filePickerRef.current.click(); //wywolanie klikniecia inputu, ktory jest niewidzialny\n  }\n\n  function handleSubmit() {\n    if (foodname === \"\") {\n      alert('Nie wprowadzono żadnej nazwy!');\n    } else {\n      sendToServer(foodname, foodimage);\n      alert('Podano następującą potrawę: ' + foodname);\n    }\n  }\n\n  function clearSuggestions() {\n    var x = document.getElementsByClassName(\"suggestion-item\");\n    var n = x.length;\n    var y = document.getElementsByClassName(\"suggestion-list\");\n\n    for (var i = 0; i < n; i++) {\n      x[0].parentNode.removeChild(x[0]);\n    }\n\n    if (y.length !== 0) {\n      y[0].parentNode.removeChild(y[0]);\n    }\n  }\n\n  function handleChange(event) {\n    clearSuggestions();\n    var b, a;\n    var inputValue = document.getElementById(\"foodinput\").value;\n\n    if (inputValue !== '') {\n      a = document.createElement(\"ul\");\n      a.setAttribute(\"class\", \"suggestion-list\");\n      a.setAttribute(\"id\", \"suggestionbox\");\n      document.getElementById('inputwrapper').appendChild(a);\n      var actualHeight = 0;\n\n      for (var i = 0; i < foodNames.length; i++) {\n        if (foodNames[i].substring(0, inputValue.length).toUpperCase() === inputValue.toUpperCase() && inputValue !== '') {\n          b = document.createElement(\"li\");\n\n          if (actualHeight < 250) {\n            actualHeight += 43;\n          }\n\n          a.style.setProperty('--height', actualHeight + 'px');\n          b.innerHTML = \"<span class='firstLetter'>\" + foodNames[i].substring(0, inputValue.length) + \"</span>\";\n          b.innerHTML += foodNames[i].substring(inputValue.length, foodNames[i].length);\n          b.innerHTML += \"<input type='hidden' value='\" + foodNames[i] + \"'>\";\n          b.setAttribute(\"class\", \"suggestion-item\");\n          b.addEventListener(\"click\", function (e) {\n            document.getElementById('foodinput').value = this.getElementsByTagName(\"input\")[0].value;\n            setFoodName(event.target.value);\n            clearSuggestions();\n          });\n          a.appendChild(b);\n        }\n      }\n    }\n\n    setFoodName(event.target.value); //jeśli się stanie zdarzenie(OnChange), wez element który je spowodował(target) i jego wartość(value)\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(MainContainer, {\n      children: [/*#__PURE__*/_jsxDEV(InputWrapper, {\n        id: \"inputwrapper\",\n        children: /*#__PURE__*/_jsxDEV(InputBar, {\n          id: \"foodinput\",\n          ref: inputBarRef,\n          value: foodname,\n          type: \"text\",\n          placeholder: \"Nazwij swoje jedzenie\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(MainContent, {\n        children: /*#__PURE__*/_jsxDEV(MainButtonWrapper, {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            value: \"Submit\",\n            onMouseEnter: onHover,\n            onMouseLeave: onHover,\n            onClick: handleSubmit,\n            children: \"Wy\\u015Blij\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(ImageUploadContent, {\n        children: [/*#__PURE__*/_jsxDEV(ImageButtonWrapper, {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            ref: filePickerRef,\n            style: {\n              display: \"none\"\n            },\n            type: \"file\",\n            accept: \".jpg,.png,.jpeg\",\n            onChange: ImageHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            id: \"imgbtn\",\n            type: \"button\",\n            onMouseEnter: onHover,\n            onMouseLeave: onHover,\n            onClick: pickedImageHandler,\n            children: \"Wybierz zdj\\u0119cie\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(ImagePreview, {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            height: \"300px\",\n            width: \"300px\",\n            src: previewUrl,\n            alt: \"preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(FooterWrapper, {\n        children: \"Jakub Sachajko & \\u0141ukasz Nied\\u017Awiadek \\xA9 2022\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(MainSection, \"S99pV7N0fRcUTXKu3F5VhRAyTn0=\");\n\n_c = MainSection;\nexport default MainSection;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainSection\");","map":{"version":3,"sources":["C:/Users/lukin/OneDrive/INF/Gourmet/src/Elements/MainSection/index.js"],"names":["React","useState","useRef","useEffect","MainContainer","InputBar","InputWrapper","Button","MainButtonWrapper","ImagePreview","MainContent","FooterWrapper","ImageUploadContent","ImageButtonWrapper","sendToServer","convertToDataURLviaCanvas","imgToBase64","getBase64FromUrl","MainSection","inputBarRef","foodNames","hover","setHover","previewUrl","setPreviewUrl","filePickerRef","foodname","setFoodName","foodimage","setFoodImage","onHover","window","addEventListener","event","container","document","getElementById","tmp","getElementsByClassName","contains","target","length","clearSuggestions","ImageHandler","files","dupa","file","reader","FileReader","onloadend","base64String","result","replace","readAsDataURL","URL","createObjectURL","innerText","pickedImageHandler","current","click","handleSubmit","alert","x","n","y","i","parentNode","removeChild","handleChange","b","a","inputValue","value","createElement","setAttribute","appendChild","actualHeight","substring","toUpperCase","style","setProperty","innerHTML","e","getElementsByTagName","display"],"mappings":"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","sourcesContent":["import React, {useState, useRef, useEffect} from 'react'\r\nimport { MainContainer,InputBar, InputWrapper, Button,MainButtonWrapper,ImagePreview, MainContent,FooterWrapper,ImageUploadContent,ImageButtonWrapper} from './MainSectionDecorations'\r\nimport '../Styles/suggestions.css'\r\nimport {sendToServer,convertToDataURLviaCanvas,imgToBase64,getBase64FromUrl} from '../../Functions/upload'\r\nconst MainSection = () => { \r\n    const inputBarRef = useRef();\r\n    const foodNames = [\"kotlet\",\"buraczki\",\"mizeria\",\"arbuz\",\"mleko\",\"melon\",\"maliny\",\"maczek\",\"marucha\",\"marchew\",\"mango\",\"mus owocowy\",\"marmolada\",\"margaryna\",\"marcepan\"];\r\n    const [hover, setHover] = useState(false)\r\n    const [previewUrl,setPreviewUrl] = useState(null);\r\n    const filePickerRef = useRef();\r\n    const [foodname,setFoodName] = useState(\"\");\r\n    const [foodimage,setFoodImage] = useState(\"\");\r\n    const onHover = () => {\r\n      setHover(!hover)\r\n    }\r\n    useEffect(() => {\r\n        window.addEventListener('click', (event) => {\r\n            var container = document.getElementById('suggestionbox');\r\n            var tmp = document.getElementsByClassName('suggestion-item');\r\n            if(container !== null)\r\n            {\r\n                if (!container.contains(event.target) && tmp.length !== 0) {\r\n                    clearSuggestions();\r\n                }\r\n            }\r\n            \r\n        });\r\n      }, []);\r\n    function ImageHandler(event) {\r\n      if(event.target.files && event.target.files.length===1 )\r\n      {\r\n        var dupa = '';\r\n        var file = event.target.files[0];\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n          // use a regex to remove data url part\r\n          const base64String = reader.result\r\n            .replace(\"data:\", \"\")\r\n            .replace(/^.+,/, \"\");\r\n    \r\n          // log to console\r\n          // logs wL2dvYWwgbW9yZ...\r\n          //console.log(base64String);\r\n          var dupa = base64String;\r\n          setFoodImage(base64String);\r\n        };\r\n        reader.readAsDataURL(file);\r\n          setPreviewUrl(URL.createObjectURL(event.target.files[0]));\r\n          document.getElementById(\"imgbtn\").innerText = \"Edytuj zdjęcie\";\r\n      }\r\n    }\r\n\r\n    function pickedImageHandler() {\r\n      filePickerRef.current.click(); //wywolanie klikniecia inputu, ktory jest niewidzialny\r\n    }\r\n    \r\n    function handleSubmit() {\r\n        if (foodname === \"\")\r\n        {\r\n            alert('Nie wprowadzono żadnej nazwy!');\r\n        }\r\n        else\r\n        {\r\n            \r\n            sendToServer(foodname,foodimage);\r\n            alert('Podano następującą potrawę: ' + foodname);\r\n        }\r\n      }\r\n    function clearSuggestions() {\r\n        var x = document.getElementsByClassName(\"suggestion-item\");\r\n        var n = x.length;\r\n        var y = document.getElementsByClassName(\"suggestion-list\");\r\n        for (var i = 0; i < n; i++) {\r\n            x[0].parentNode.removeChild(x[0]);\r\n        }\r\n        if(y.length !== 0)\r\n        {\r\n            y[0].parentNode.removeChild(y[0]);\r\n        }\r\n        \r\n    }\r\n\r\n    function handleChange(event) {\r\n        clearSuggestions();\r\n        var b,a; \r\n        var inputValue = document.getElementById(\"foodinput\").value;\r\n        if(inputValue !== '')\r\n        {\r\n            a = document.createElement(\"ul\")\r\n            a.setAttribute(\"class\", \"suggestion-list\");\r\n            a.setAttribute(\"id\", \"suggestionbox\");\r\n            document.getElementById('inputwrapper').appendChild(a);\r\n            var actualHeight = 0;\r\n            for (var i = 0; i < foodNames.length; i++)\r\n            {\r\n                if(foodNames[i].substring(0,inputValue.length).toUpperCase() === inputValue.toUpperCase() && inputValue !== '')\r\n                {\r\n                    b = document.createElement(\"li\");\r\n                    if(actualHeight < 250)\r\n                    {\r\n                        actualHeight += 43;\r\n                    }\r\n                    a.style.setProperty('--height',actualHeight+'px')\r\n                    b.innerHTML=\"<span class='firstLetter'>\" + foodNames[i].substring(0,inputValue.length) + \"</span>\";\r\n                    b.innerHTML += foodNames[i].substring(inputValue.length,foodNames[i].length);\r\n                    b.innerHTML += \"<input type='hidden' value='\" + foodNames[i] + \"'>\";\r\n                    b.setAttribute(\"class\", \"suggestion-item\");\r\n                    b.addEventListener(\"click\", function(e) {\r\n                        document.getElementById('foodinput').value = this.getElementsByTagName(\"input\")[0].value;\r\n                        setFoodName(event.target.value);\r\n                        clearSuggestions();\r\n                    });\r\n                    a.appendChild(b);\r\n                }\r\n            }\r\n        }\r\n        setFoodName(event.target.value); //jeśli się stanie zdarzenie(OnChange), wez element który je spowodował(target) i jego wartość(value)\r\n    }\r\n    return (\r\n        <>\r\n        <MainContainer>\r\n            {/* obniżyć przycisk wybierz zdjęcie, na urządzeniach mobilnych zmiejszyć imagepreview */}\r\n            {/* <Autocomplete suggestions={[\"Oranges\", \"Orangutan\", \"Apples\", \"Banana\", \"Kiwi\", \"Mango\"]}/> */}\r\n            <InputWrapper id=\"inputwrapper\">\r\n                {/* <SuggestionList id=\"suggestionbox\"/> */}\r\n                <InputBar id=\"foodinput\" ref={inputBarRef} value={foodname} type=\"text\" placeholder='Nazwij swoje jedzenie' onChange={handleChange}/>\r\n            </InputWrapper>\r\n            \r\n            <MainContent>\r\n                <MainButtonWrapper>\r\n                  <Button type=\"submit\" value=\"Submit\" onMouseEnter={onHover} onMouseLeave={onHover} onClick={handleSubmit}>\r\n                      Wyślij\r\n                  </Button>\r\n                </MainButtonWrapper>     \r\n            </MainContent>   \r\n            <ImageUploadContent>\r\n                <ImageButtonWrapper>\r\n                <input ref = {filePickerRef} style = {{display:\"none\"}} type = \"file\" accept=\".jpg,.png,.jpeg\" onChange={ImageHandler} />\r\n                    <Button id=\"imgbtn\" type=\"button\" onMouseEnter={onHover} onMouseLeave={onHover} onClick={pickedImageHandler}>\r\n                        Wybierz zdjęcie \r\n                    </Button>\r\n                </ImageButtonWrapper>\r\n                <ImagePreview>\r\n                    <img height=\"300px\" width=\"300px\" src={previewUrl} alt=\"preview\"/>\r\n                </ImagePreview>\r\n            </ImageUploadContent>\r\n\r\n            <FooterWrapper>Jakub Sachajko & Łukasz Niedźwiadek © 2022</FooterWrapper>\r\n        </MainContainer>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default MainSection\r\n"]},"metadata":{},"sourceType":"module"}