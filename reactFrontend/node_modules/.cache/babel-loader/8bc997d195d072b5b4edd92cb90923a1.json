{"ast":null,"code":"var _jsxFileName = \"D:\\\\Politechnika\\\\The Gourmet\\\\Development\\\\reactFrontend\\\\src\\\\Elements\\\\MainSection\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { MainContainer, InputBar, InputWrapper, Button, MainButtonWrapper, ImagePreview, MainContent, FooterWrapper, ImageUploadContent, ImageButtonWrapper } from './MainSectionDecorations';\nimport '../Styles/suggestions.css';\nimport Resizer from \"react-image-file-resizer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst MainSection = () => {\n  _s();\n\n  const backendURL = 'http://localhost:5000'; //const backendURL = 'https://gourmet.hopto.org:5000'\n\n  const inputBarRef = useRef();\n  const [hover, setHover] = useState(false);\n  const [previewUrl, setPreviewUrl] = useState(null);\n  const filePickerRef = useRef();\n  const [foodname, setFoodName] = useState(\"\");\n  const [foodimage, setFoodImage] = useState(\"\");\n  const [foodNames, setFoodNames] = useState(\"\");\n\n  const onHover = () => {\n    setHover(!hover);\n  };\n\n  useEffect(() => {\n    window.addEventListener('click', event => {\n      var container = document.getElementById('suggestionbox');\n      var tmp = document.getElementsByClassName('suggestion-item');\n\n      if (container !== null) {\n        if (!container.contains(event.target) && tmp.length !== 0) {\n          clearSuggestions();\n        }\n      }\n    });\n  }, []);\n\n  function ImageHandler(event) {\n    if (event.target.files && event.target.files.length === 1) {\n      var file = event.target.files[0];\n      Resizer.imageFileResizer(file, 400, 400, \"JPEG\", 100, 0, uri => {\n        const base64String = uri.replace(\"data:\", \"\").replace(/^.+,/, \"\");\n        setFoodImage(base64String);\n      }, \"base64\", 300, 300);\n      setPreviewUrl(URL.createObjectURL(event.target.files[0]));\n      document.getElementById(\"imgbtn\").innerText = \"Edytuj zdjęcie\";\n    }\n  }\n\n  function pickedImageHandler() {\n    filePickerRef.current.click(); //wywolanie klikniecia inputu, ktory jest niewidzialny\n  }\n\n  function handleSubmit() {\n    if (foodname === \"\") {\n      alert('Nie wprowadzono żadnej nazwy!');\n    }\n\n    if (foodimage === \"\") {\n      alert('Nie wybrano zdjęcia!');\n    } else {\n      alert('Podano następującą potrawę: ' + foodname);\n      handleRequest(foodname, foodimage);\n    }\n  }\n\n  window.onload = function getSuggestions() {\n    var xmlHttp = new XMLHttpRequest();\n    xmlHttp.open(\"GET\", backendURL + '/suggestions', false); // false for synchronous request\n\n    xmlHttp.send(null);\n    var sug = JSON.parse(xmlHttp.response);\n    setFoodNames(sug);\n  };\n\n  function handleRequest(foodname, foodimage) {\n    const xhttp = new XMLHttpRequest();\n    var res;\n    xhttp.open(\"POST\", backendURL + '/meals', true);\n    const request = {\n      'mealName': foodname,\n      'mealPhoto': foodimage\n    };\n\n    xhttp.onreadystatechange = function () {\n      if (xhttp.readyState === 4) {\n        res = JSON.parse(xhttp.response);\n        console.log(res);\n        alert(foodname + ' został pomyślnie zapisany');\n        setFoodNames(res);\n      }\n    };\n\n    xhttp.setRequestHeader('Content-Type', 'application/json');\n    xhttp.send(JSON.stringify(request));\n  }\n\n  function clearSuggestions() {\n    var x = document.getElementsByClassName(\"suggestion-item\");\n    var n = x.length;\n    var y = document.getElementsByClassName(\"suggestion-list\");\n\n    for (var i = 0; i < n; i++) {\n      x[0].parentNode.removeChild(x[0]);\n    }\n\n    if (y.length !== 0) {\n      y[0].parentNode.removeChild(y[0]);\n    }\n  }\n\n  function handleChange(event) {\n    clearSuggestions(); //getSuggestions();\n\n    var b, a;\n    var inputValue = document.getElementById(\"foodinput\").value;\n\n    if (inputValue !== '') {\n      a = document.createElement(\"ul\");\n      a.setAttribute(\"class\", \"suggestion-list\");\n      a.setAttribute(\"id\", \"suggestionbox\");\n      document.getElementById('inputwrapper').appendChild(a);\n      var actualHeight = 0;\n\n      for (var i = 0; i < foodNames.length; i++) {\n        if (foodNames[i].substring(0, inputValue.length).toUpperCase() === inputValue.toUpperCase() && inputValue !== '') {\n          b = document.createElement(\"li\");\n\n          if (actualHeight < 250) {\n            actualHeight += 43;\n          }\n\n          a.style.setProperty('--height', actualHeight + 'px');\n          b.innerHTML = \"<span class='firstLetter'>\" + foodNames[i].substring(0, inputValue.length) + \"</span>\";\n          b.innerHTML += foodNames[i].substring(inputValue.length, foodNames[i].length);\n          b.innerHTML += \"<input type='hidden' value='\" + foodNames[i] + \"'>\";\n          b.setAttribute(\"class\", \"suggestion-item\");\n          b.addEventListener(\"click\", function (e) {\n            document.getElementById('foodinput').value = this.getElementsByTagName(\"input\")[0].value;\n            setFoodName(event.target.value);\n            clearSuggestions();\n          });\n          a.appendChild(b);\n        }\n      }\n    }\n\n    setFoodName(event.target.value); //jeśli się stanie zdarzenie(OnChange), wez element który je spowodował(target) i jego wartość(value)\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(MainContainer, {\n      children: [/*#__PURE__*/_jsxDEV(InputWrapper, {\n        id: \"inputwrapper\",\n        children: /*#__PURE__*/_jsxDEV(InputBar, {\n          id: \"foodinput\",\n          ref: inputBarRef,\n          value: foodname,\n          type: \"text\",\n          placeholder: \"Nazwij swoje jedzenie\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(MainContent, {\n        children: /*#__PURE__*/_jsxDEV(MainButtonWrapper, {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            value: \"Submit\",\n            onMouseEnter: onHover,\n            onMouseLeave: onHover,\n            onClick: handleSubmit,\n            children: \"Wy\\u015Blij\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(ImageUploadContent, {\n        children: [/*#__PURE__*/_jsxDEV(ImageButtonWrapper, {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            ref: filePickerRef,\n            style: {\n              display: \"none\"\n            },\n            type: \"file\",\n            accept: \".jpg,.png,.jpeg\",\n            onChange: ImageHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            id: \"imgbtn\",\n            type: \"button\",\n            onMouseEnter: onHover,\n            onMouseLeave: onHover,\n            onClick: pickedImageHandler,\n            children: \"Wybierz zdj\\u0119cie\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(ImagePreview, {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            height: \"300px\",\n            width: \"300px\",\n            src: previewUrl,\n            alt: \"preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(FooterWrapper, {\n        children: \"Jakub Sachajko & \\u0141ukasz Nied\\u017Awiadek \\xA9 2022\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(MainSection, \"9fi/fxId/sX0noXrIYmXKbrbqaE=\");\n\n_c = MainSection;\nexport default MainSection;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainSection\");","map":{"version":3,"sources":["D:/Politechnika/The Gourmet/Development/reactFrontend/src/Elements/MainSection/index.js"],"names":["React","useState","useRef","useEffect","MainContainer","InputBar","InputWrapper","Button","MainButtonWrapper","ImagePreview","MainContent","FooterWrapper","ImageUploadContent","ImageButtonWrapper","Resizer","MainSection","backendURL","inputBarRef","hover","setHover","previewUrl","setPreviewUrl","filePickerRef","foodname","setFoodName","foodimage","setFoodImage","foodNames","setFoodNames","onHover","window","addEventListener","event","container","document","getElementById","tmp","getElementsByClassName","contains","target","length","clearSuggestions","ImageHandler","files","file","imageFileResizer","uri","base64String","replace","URL","createObjectURL","innerText","pickedImageHandler","current","click","handleSubmit","alert","handleRequest","onload","getSuggestions","xmlHttp","XMLHttpRequest","open","send","sug","JSON","parse","response","xhttp","res","request","onreadystatechange","readyState","console","log","setRequestHeader","stringify","x","n","y","i","parentNode","removeChild","handleChange","b","a","inputValue","value","createElement","setAttribute","appendChild","actualHeight","substring","toUpperCase","style","setProperty","innerHTML","e","getElementsByTagName","display"],"mappings":"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","sourcesContent":["import React, {useState, useRef, useEffect} from 'react'\r\nimport { MainContainer,InputBar, InputWrapper, Button,MainButtonWrapper,ImagePreview, MainContent,FooterWrapper,ImageUploadContent,ImageButtonWrapper} from './MainSectionDecorations'\r\nimport '../Styles/suggestions.css'\r\nimport Resizer from \"react-image-file-resizer\";\r\nconst MainSection = () => { \r\n    const backendURL =  'http://localhost:5000';\r\n    //const backendURL = 'https://gourmet.hopto.org:5000'\r\n    const inputBarRef = useRef();\r\n    const [hover, setHover] = useState(false)\r\n    const [previewUrl,setPreviewUrl] = useState(null);\r\n    const filePickerRef = useRef();\r\n    const [foodname,setFoodName] = useState(\"\");\r\n    const [foodimage,setFoodImage] = useState(\"\");\r\n    const [foodNames,setFoodNames] = useState(\"\");\r\n    const onHover = () => {\r\n      setHover(!hover)\r\n    }\r\n    useEffect(() => {\r\n        window.addEventListener('click', (event) => {\r\n            var container = document.getElementById('suggestionbox');\r\n            var tmp = document.getElementsByClassName('suggestion-item');\r\n            if(container !== null)\r\n            {\r\n                if (!container.contains(event.target) && tmp.length !== 0) {\r\n                    clearSuggestions();\r\n                }\r\n            }\r\n            \r\n        });\r\n      }, []);\r\n    function ImageHandler(event) {\r\n      if(event.target.files && event.target.files.length===1 )\r\n      {\r\n        var file = event.target.files[0];\r\n        Resizer.imageFileResizer(\r\n            file,\r\n            400,\r\n            400,\r\n            \"JPEG\",\r\n            100,\r\n            0,\r\n            (uri) => {\r\n              const base64String = uri.replace(\"data:\", \"\").replace(/^.+,/, \"\");\r\n              setFoodImage(base64String);\r\n            },\r\n            \"base64\",\r\n            300,\r\n            300\r\n          ); \r\n        setPreviewUrl(URL.createObjectURL(event.target.files[0]));\r\n        document.getElementById(\"imgbtn\").innerText = \"Edytuj zdjęcie\";\r\n      }\r\n    }\r\n\r\n    function pickedImageHandler() {\r\n      filePickerRef.current.click(); //wywolanie klikniecia inputu, ktory jest niewidzialny\r\n    }\r\n    \r\n    function handleSubmit() {\r\n        if (foodname === \"\")\r\n        {\r\n            alert('Nie wprowadzono żadnej nazwy!');\r\n        }\r\n        if (foodimage === \"\")\r\n        {\r\n            alert('Nie wybrano zdjęcia!');\r\n        }\r\n        else\r\n        {\r\n            alert('Podano następującą potrawę: ' + foodname);\r\n            handleRequest(foodname,foodimage)\r\n        }\r\n      }\r\n    window.onload = function getSuggestions()\r\n    {\r\n        var xmlHttp = new XMLHttpRequest();\r\n        xmlHttp.open( \"GET\", backendURL + '/suggestions', false ); // false for synchronous request\r\n        xmlHttp.send( null );\r\n        var sug = JSON.parse(xmlHttp.response);\r\n        setFoodNames(sug)\r\n    }\r\n    function handleRequest(foodname,foodimage)\r\n    {\r\n        const xhttp = new XMLHttpRequest();\r\n        var res;\r\n        xhttp.open(\"POST\", backendURL + '/meals', true);\r\n        const request = {\r\n            'mealName': foodname,\r\n            'mealPhoto': foodimage,\r\n        };\r\n        xhttp.onreadystatechange = function() {\r\n            if (xhttp.readyState === 4) {\r\n            res = JSON.parse(xhttp.response)\r\n            console.log(res)\r\n            alert(foodname + ' został pomyślnie zapisany');\r\n            setFoodNames(res)\r\n            }\r\n        }\r\n        xhttp.setRequestHeader('Content-Type', 'application/json');\r\n        xhttp.send(JSON.stringify(request));\r\n    }\r\n    function clearSuggestions() {\r\n        var x = document.getElementsByClassName(\"suggestion-item\");\r\n        var n = x.length;\r\n        var y = document.getElementsByClassName(\"suggestion-list\");\r\n        for (var i = 0; i < n; i++) {\r\n            x[0].parentNode.removeChild(x[0]);\r\n        }\r\n        if(y.length !== 0)\r\n        {\r\n            y[0].parentNode.removeChild(y[0]);\r\n        }\r\n        \r\n    }\r\n\r\n    function handleChange(event) {\r\n        clearSuggestions();\r\n        //getSuggestions();\r\n        var b,a; \r\n        var inputValue = document.getElementById(\"foodinput\").value;\r\n        if(inputValue !== '')\r\n        {\r\n            a = document.createElement(\"ul\")\r\n            a.setAttribute(\"class\", \"suggestion-list\");\r\n            a.setAttribute(\"id\", \"suggestionbox\");\r\n            document.getElementById('inputwrapper').appendChild(a);\r\n            var actualHeight = 0;\r\n            for (var i = 0; i < foodNames.length; i++)\r\n            {\r\n                if(foodNames[i].substring(0,inputValue.length).toUpperCase() === inputValue.toUpperCase() && inputValue !== '')\r\n                {\r\n                    b = document.createElement(\"li\");\r\n                    if(actualHeight < 250)\r\n                    {\r\n                        actualHeight += 43;\r\n                    }\r\n                    a.style.setProperty('--height',actualHeight+'px')\r\n                    b.innerHTML=\"<span class='firstLetter'>\" + foodNames[i].substring(0,inputValue.length) + \"</span>\";\r\n                    b.innerHTML += foodNames[i].substring(inputValue.length,foodNames[i].length);\r\n                    b.innerHTML += \"<input type='hidden' value='\" + foodNames[i] + \"'>\";\r\n                    b.setAttribute(\"class\", \"suggestion-item\");\r\n                    b.addEventListener(\"click\", function(e) {\r\n                        document.getElementById('foodinput').value = this.getElementsByTagName(\"input\")[0].value;\r\n                        setFoodName(event.target.value);\r\n                        clearSuggestions();\r\n                    });\r\n                    a.appendChild(b);\r\n                }\r\n            }\r\n        }\r\n        setFoodName(event.target.value); //jeśli się stanie zdarzenie(OnChange), wez element który je spowodował(target) i jego wartość(value)\r\n    }\r\n    return (\r\n        <>\r\n        <MainContainer>\r\n            {/* obniżyć przycisk wybierz zdjęcie, na urządzeniach mobilnych zmiejszyć imagepreview */}\r\n            {/* <Autocomplete suggestions={[\"Oranges\", \"Orangutan\", \"Apples\", \"Banana\", \"Kiwi\", \"Mango\"]}/> */}\r\n            <InputWrapper id=\"inputwrapper\">\r\n                {/* <SuggestionList id=\"suggestionbox\"/> */}\r\n                <InputBar id=\"foodinput\" ref={inputBarRef} value={foodname} type=\"text\" placeholder='Nazwij swoje jedzenie' onChange={handleChange}/>\r\n            </InputWrapper>\r\n            \r\n            <MainContent>\r\n                <MainButtonWrapper>\r\n                  <Button type=\"submit\" value=\"Submit\" onMouseEnter={onHover} onMouseLeave={onHover} onClick={handleSubmit}>\r\n                      Wyślij\r\n                  </Button>\r\n                </MainButtonWrapper>     \r\n            </MainContent>   \r\n            <ImageUploadContent>\r\n                <ImageButtonWrapper>\r\n                <input ref = {filePickerRef} style = {{display:\"none\"}} type = \"file\" accept=\".jpg,.png,.jpeg\" onChange={ImageHandler} />\r\n                    <Button id=\"imgbtn\" type=\"button\" onMouseEnter={onHover} onMouseLeave={onHover} onClick={pickedImageHandler}>\r\n                        Wybierz zdjęcie \r\n                    </Button>\r\n                </ImageButtonWrapper>\r\n                <ImagePreview>\r\n                    <img height=\"300px\" width=\"300px\" src={previewUrl} alt=\"preview\"/>\r\n                </ImagePreview>\r\n            </ImageUploadContent>\r\n\r\n            <FooterWrapper>Jakub Sachajko & Łukasz Niedźwiadek © 2022</FooterWrapper>\r\n        </MainContainer>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default MainSection"]},"metadata":{},"sourceType":"module"}